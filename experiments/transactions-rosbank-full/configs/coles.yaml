defaults:
  - default
  - _self_

name: coles

data_module:
  batch_size: 32

module:
  _target_: pretpp.modules.BaseModule
  seq_encoder:
    rnn_partial:
      _target_: hotpp.nn.GRU
      _partial_: true
      hidden_size: 1024
    max_inference_context: ${rnn_inference_context}
    inference_context_step: ${rnn_inference_context_step}
  optimizer_partial:
    _target_: torch.optim.Adam
    lr: 0.004
  lr_scheduler_partial:
    gamma: 0.9025
    step_size: 10
  loss_projection_partial: ${nohead}
  loss:
    _target_: pretpp.losses.ColesLoss
    embedding_dim: 1024
    coles_loss:
      _target_: ptls.frames.coles.losses.ContrastiveLoss
      margin: 0.5
      sampling_strategy:
        _target_: ptls.frames.coles.sampling_strategies.HardNegativePairSelector
        neg_count: 5
trainer:
  max_epochs: 110
  check_val_every_n_epoch: 10
