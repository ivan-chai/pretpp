defaults:
  - default
  - default_bitransformer
  - _self_

name: coles_bitransformer

module:
  _target_: pretpp.modules.BaseModule
  head_partial:
    _target_: pretpp.nn.NormalizationHead
    _partial_: true
  loss_projection_partial: ${nohead}
  loss:
    _target_: pretpp.losses.ColesLoss
    embedding_dim: ${transformer_hidden_size}
    min_length: 16
    max_length: 48
    n_splits: 5
    coles_loss:
      _target_: ptls.frames.coles.losses.ContrastiveLoss
      margin: 0.5
      sampling_strategy:
        _target_: ptls.frames.coles.sampling_strategies.HardNegativePairSelector
        neg_count: 5
    cls_token: ${transformer_cls_token}
