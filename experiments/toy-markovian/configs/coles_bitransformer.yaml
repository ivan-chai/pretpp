defaults:
  - default
  - default_bitransformer
  - coles_loss@module.loss
  - _self_

name: coles_bitransformer

module:
  _target_: pretpp.modules.BaseModule
  head_partial:
    _target_: pretpp.nn.NormalizationHead
    _partial_: true
  loss_projection_partial: ${nohead}
  loss:
    embedding_dim: ${module.seq_encoder.model_partial.n_embd}
    cls_token: ${cls_token}
    cls_token_begin: true
  aggregator:
    _target_: hotpp.nn.FirstAggregator
